{extend name="public/base" /}

{block name="body"}

<div class="row">
    <div class="col-md-8">
        <div class="page-header">
            <p>
                <span style="font-size: 24px">发布文章</span>&nbsp;&nbsp;
            </p>
        </div>

        <form class="form-horizontal" id="login" action="{:url('Article/insert')}" method="post" enctype="multipart/form-data">
            <div>
                <input type="hidden" name="user_id" value="{$Think.session.id}">
            </div>
            <div class="form-group">
                <label  class="col-sm-2 control-label">文章标题</label>
                <div class="col-sm-10">
                    <input type="text" name="title" class="form-control" placeholder="请输入文章标题">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">文章分类</label>
                <div class="col-sm-10">
                    <select name="cate_id" class="form-control">
                        {volist name="cateList" id="cate"}
                            <option value="{$cate.id}">{$cate.name}</option>
                        {/volist}
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">标题图片</label>
                <div class="col-sm-10">
                    <input type="file" name="title_img" class="form-control" placeholder="请选择标题图片">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">文章内容</label>
                <div class="col-sm-10">
                    <!--<textarea name="content" id="content" style="height: 200px" class="form-control"></textarea>-->
                    <textarea name="content" style="width:700px;height:200px;visibility:hidden;"><?php echo htmlspecialchars($htmlData); ?></textarea>
                    <br />
                </div>
            </div>

            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="submit" class="btn btn-default" id="submit">发布</button>
                </div>
            </div>
        </form>
    </div>

    <script type="text/javascript">
        bkLib.onDomLoaded(function() {
            new nicEditor({iconsPath : '/static/js/nicEditorIcons.gif'}).panelInstance('content');
        });

    </script>
    <script>
        KindEditor.ready(function(K) {
            var editor1 = K.create('textarea[name="content"]', {
                cssPath : '../plugins/code/prettify.css',
                uploadJson : '../php/upload_json.php',
                fileManagerJson : '../php/file_manager_json.php',
                allowFileManager : true,
                afterCreate : function() {
                    var self = this;
                    K.ctrl(document, 13, function() {
                        self.sync();
                        K('form[name=example]')[0].submit();
                    });
                    K.ctrl(self.edit.doc, 13, function() {
                        self.sync();
                        K('form[name=example]')[0].submit();
                    });
                }
            });
            prettyPrint();
        });
    </script>

    <!--右侧最新排行-->
    {/block}